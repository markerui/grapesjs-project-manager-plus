/*! grapesjs-project-manager-plus - 1.0.8 */
!function(e,t){'object'==typeof exports&&'object'==typeof module?module.exports=t():'function'==typeof define&&define.amd?define([],t):'object'==typeof exports?exports["grapesjs-project-manager-plus"]=t():e["grapesjs-project-manager-plus"]=t()}(window,(function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var a=t[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,n),a.l=!0,a.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){'undefined'!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:'Module'}),Object.defineProperty(e,'__esModule',{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&'object'==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,'default',{enumerable:!0,value:e}),2&t&&'string'!=typeof e)for(var a in e)n.d(r,a,function(t){return e[t]}.bind(null,a));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e['default']}:function(){return e};return n.d(t,'a',t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=24)}([function(e,t,n){var r=n(17)();e.exports=r;try{regeneratorRuntime=r}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=r:Function("r","regeneratorRuntime = r")(r)}},function(e,t){function n(e,t,n,r,a,o,i){try{var s=e[o](i),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(r,a)}e.exports=function(e){return function(){var t=this,r=arguments;return new Promise((function(a,o){var i=e.apply(t,r);function s(e){n(i,a,o,s,c,"next",e)}function c(e){n(i,a,o,s,c,"throw",e)}s(void 0)}))}},e.exports.__esModule=!0,e.exports["default"]=e.exports},function(e,t){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e},e.exports.__esModule=!0,e.exports["default"]=e.exports},function(e,t,n){var r=n(14);e.exports=function(e,t,n){return(t=r(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e},e.exports.__esModule=!0,e.exports["default"]=e.exports},function(e,t){function n(t){return e.exports=n=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},e.exports.__esModule=!0,e.exports["default"]=e.exports,n(t)}e.exports=n,e.exports.__esModule=!0,e.exports["default"]=e.exports},function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},e.exports.__esModule=!0,e.exports["default"]=e.exports},function(e,t,n){var r=n(14);function a(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,r(a.key),a)}}e.exports=function(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e},e.exports.__esModule=!0,e.exports["default"]=e.exports},function(e,t,n){var r=n(18);e.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&r(e,t)},e.exports.__esModule=!0,e.exports["default"]=e.exports},function(e,t,n){var r=n(9)["default"],a=n(2);e.exports=function(e,t){if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return a(e)},e.exports.__esModule=!0,e.exports["default"]=e.exports},function(e,t){function n(t){return e.exports=n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports["default"]=e.exports,n(t)}e.exports=n,e.exports.__esModule=!0,e.exports["default"]=e.exports},function(e,t,n){var r=n(23);e.exports=function(e,t){if(null==e)return{};var n,a,o=r(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o},e.exports.__esModule=!0,e.exports["default"]=e.exports},function(e,t){e.exports=function(e){throw new TypeError("\""+e+"\" is read-only")},e.exports.__esModule=!0,e.exports["default"]=e.exports},function(e,t,n){var r=n(19),a=n(20),o=n(21),i=n(22);e.exports=function(e){return r(e)||a(e)||o(e)||i()},e.exports.__esModule=!0,e.exports["default"]=e.exports},function(e,t,n){!function(t){'use strict';var n=function(){return{escape:function(e){return e.replace(/([.*+?^${}()|\[\]\/\\])/g,'\\$1')},parseExtension:t,mimeType:function(e){var n=t(e).toLowerCase();return(r='application/font-woff',a='image/jpeg',{woff:r,woff2:r,ttf:'application/font-truetype',eot:'application/vnd.ms-fontobject',png:'image/png',jpg:a,jpeg:a,gif:'image/gif',tiff:'image/tiff',svg:'image/svg+xml'})[n]||'';var r,a},dataAsUrl:function(e,t){return'data:'+t+';base64,'+e},isDataUrl:function(e){return-1!==e.search(/^(data:)/)},canvasToBlob:function(e){return e.toBlob?new Promise((function(t){e.toBlob(t)})):function(e){return new Promise((function(t){for(var n=window.atob(e.toDataURL().split(',')[1]),r=n.length,a=new Uint8Array(r),o=0;o<r;o++)a[o]=n.charCodeAt(o);t(new Blob([a],{type:'image/png'}))}))}(e)},resolveUrl:function(e,t){var n=document.implementation.createHTMLDocument(),r=n.createElement('base');n.head.appendChild(r);var a=n.createElement('a');return n.body.appendChild(a),r.href=t,a.href=e,a.href},getAndEncode:function(e){var t=3e4;s.impl.options.cacheBust&&(e+=(/\?/.test(e)?"&":"?")+(new Date).getTime());return new Promise((function(n){var r,a=new XMLHttpRequest;if(a.onreadystatechange=function(){if(4!==a.readyState)return;if(200!==a.status)return void(r?n(r):i('cannot fetch resource: '+e+', status: '+a.status));var t=new FileReader;t.onloadend=function(){var e=t.result.split(/,/)[1];n(e)},t.readAsDataURL(a.response)},a.ontimeout=function(){r?n(r):i('timeout of '+t+'ms occured while fetching resource: '+e)},a.responseType='blob',a.timeout=t,a.open('GET',e,!0),a.send(),s.impl.options.imagePlaceholder){var o=s.impl.options.imagePlaceholder.split(/,/);o&&o[1]&&(r=o[1])}function i(e){console.error(e),n('')}}))},uid:(e=0,function(){return'u'+('0000'+(Math.random()*Math.pow(36,4)<<0).toString(36)).slice(-4)+e++}),delay:function(e){return function(t){return new Promise((function(n){setTimeout((function(){n(t)}),e)}))}},asArray:function(e){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t},escapeXhtml:function(e){return e.replace(/#/g,'%23').replace(/\n/g,'%0A')},makeImage:function(e){return new Promise((function(t,n){var r=new Image;r.onload=function(){t(r)},r.onerror=n,r.src=e}))},width:function(e){var t=n(e,'border-left-width'),r=n(e,'border-right-width');return e.scrollWidth+t+r},height:function(e){var t=n(e,'border-top-width'),r=n(e,'border-bottom-width');return e.scrollHeight+t+r}};var e;function t(e){var t=/\.([^\.\/]*?)$/g.exec(e);return t?t[1]:''}function n(e,t){var n=window.getComputedStyle(e).getPropertyValue(t);return parseFloat(n.replace('px',''))}}(),r=function(){var e=/url\(['"]?([^'"]+?)['"]?\)/g;return{inlineAll:function(e,n,o){return function(){return!t(e)}()?Promise.resolve(e):Promise.resolve(e).then(r).then((function(t){var r=Promise.resolve(e);return t.forEach((function(e){r=r.then((function(t){return a(t,e,n,o)}))})),r}))},shouldProcess:t,impl:{readUrls:r,inline:a}};function t(t){return-1!==t.search(e)}function r(t){for(var r,a=[];null!==(r=e.exec(t));)a.push(r[1]);return a.filter((function(e){return!n.isDataUrl(e)}))}function a(e,t,r,a){return Promise.resolve(t).then((function(e){return r?n.resolveUrl(e,r):e})).then(a||n.getAndEncode).then((function(e){return n.dataAsUrl(e,n.mimeType(t))})).then((function(r){return e.replace(function(e){return new RegExp('(url\\([\'"]?)('+n.escape(e)+')([\'"]?\\))','g')}(t),'$1'+r+'$3')}))}}(),a=function(){return{resolveAll:function(){return e(document).then((function(e){return Promise.all(e.map((function(e){return e.resolve()})))})).then((function(e){return e.join('\n')}))},impl:{readAll:e}};function e(){return Promise.resolve(n.asArray(document.styleSheets)).then((function(e){var t=[];return e.forEach((function(e){try{n.asArray(e.cssRules||[]).forEach(t.push.bind(t))}catch(t){console.log('Error while reading CSS rules from '+e.href,t.toString())}})),t})).then((function(e){return e.filter((function(e){return e.type===CSSRule.FONT_FACE_RULE})).filter((function(e){return r.shouldProcess(e.style.getPropertyValue('src'))}))})).then((function(t){return t.map(e)}));function e(e){return{resolve:function(){var t=(e.parentStyleSheet||{}).href;return r.inlineAll(e.cssText,t)},src:function(){return e.style.getPropertyValue('src')}}}}}(),o=function(){return{inlineAll:function t(a){return a instanceof Element?function(e){var t=e.style.getPropertyValue('background');return t?r.inlineAll(t).then((function(t){e.style.setProperty('background',t,e.style.getPropertyPriority('background'))})).then((function(){return e})):Promise.resolve(e)}(a).then((function(){return a instanceof HTMLImageElement?e(a).inline():Promise.all(n.asArray(a.childNodes).map((function(e){return t(e)})))})):Promise.resolve(a)},impl:{newImage:e}};function e(e){return{inline:function(t){return n.isDataUrl(e.src)?Promise.resolve():Promise.resolve(e.src).then(t||n.getAndEncode).then((function(t){return n.dataAsUrl(t,n.mimeType(e.src))})).then((function(t){return new Promise((function(n,r){e.onload=n,e.onerror=r,e.src=t}))}))}}}}(),i={imagePlaceholder:void 0,cacheBust:!1},s={toSvg:c,toPng:function(e,t){return l(e,t||{}).then((function(e){return e.toDataURL()}))},toJpeg:function(e,t){return l(e,t=t||{}).then((function(e){return e.toDataURL('image/jpeg',t.quality||1)}))},toBlob:function(e,t){return l(e,t||{}).then(n.canvasToBlob)},toPixelData:function(e,t){return l(e,t||{}).then((function(t){return t.getContext('2d').getImageData(0,0,n.width(e),n.height(e)).data}))},impl:{fontFaces:a,images:o,util:n,inliner:r,options:{}}};function c(e,t){return function(e){void 0===e.imagePlaceholder?s.impl.options.imagePlaceholder=i.imagePlaceholder:s.impl.options.imagePlaceholder=e.imagePlaceholder;void 0===e.cacheBust?s.impl.options.cacheBust=i.cacheBust:s.impl.options.cacheBust=e.cacheBust}(t=t||{}),Promise.resolve(e).then((function(e){return function e(t,r,a){return a||!r||r(t)?Promise.resolve(t).then((function(e){return e instanceof HTMLCanvasElement?n.makeImage(e.toDataURL()):e.cloneNode(!1)})).then((function(e){return o(t,e,r)})).then((function(e){return function(e,t){return t instanceof Element?Promise.resolve().then(r).then(a).then(o).then(i).then((function(){return t})):t;function r(){var r,a;r=window.getComputedStyle(e),a=t.style,r.cssText?a.cssText=r.cssText:function(e,t){n.asArray(e).forEach((function(n){t.setProperty(n,e.getPropertyValue(n),e.getPropertyPriority(n))}))}(r,a)}function a(){[':before',':after'].forEach((function(r){!function(r){var a=window.getComputedStyle(e,r),o=a.getPropertyValue('content');if(''===o||'none'===o)return;var i=n.uid();t.className=t.className+' '+i;var s=document.createElement('style');s.appendChild(function(e,t,r){var a='.'+e+':'+t,o=r.cssText?function(e){var t=e.getPropertyValue('content');return e.cssText+' content: '+t+';'}(r):function(e){return n.asArray(e).map((function(t){return t+': '+e.getPropertyValue(t)+(e.getPropertyPriority(t)?' !important':'')})).join('; ')+';'}(r);return document.createTextNode(a+'{'+o+'}')}(i,r,a)),t.appendChild(s)}(r)}))}function o(){e instanceof HTMLTextAreaElement&&(t.innerHTML=e.value),e instanceof HTMLInputElement&&t.setAttribute("value",e.value)}function i(){t instanceof SVGElement&&(t.setAttribute('xmlns','http://www.w3.org/2000/svg'),t instanceof SVGRectElement&&['width','height'].forEach((function(e){var n=t.getAttribute(e);n&&t.style.setProperty(e,n)})))}}(t,e)})):Promise.resolve();function o(t,r,a){var o=t.childNodes;return 0===o.length?Promise.resolve(r):i(r,n.asArray(o),a).then((function(){return r}));function i(t,n,r){var a=Promise.resolve();return n.forEach((function(n){a=a.then((function(){return e(n,r)})).then((function(e){e&&t.appendChild(e)}))})),a}}}(e,t.filter,!0)})).then(u).then(d).then((function(e){t.bgcolor&&(e.style.backgroundColor=t.bgcolor);t.width&&(e.style.width=t.width+'px');t.height&&(e.style.height=t.height+'px');t.style&&Object.keys(t.style).forEach((function(n){e.style[n]=t.style[n]}));return e})).then((function(r){return function(e,t,r){return Promise.resolve(e).then((function(e){return e.setAttribute('xmlns','http://www.w3.org/1999/xhtml'),(new XMLSerializer).serializeToString(e)})).then(n.escapeXhtml).then((function(e){return'<foreignObject x="0" y="0" width="100%" height="100%">'+e+'</foreignObject>'})).then((function(e){return'<svg xmlns="http://www.w3.org/2000/svg" width="'+t+'" height="'+r+'">'+e+'</svg>'})).then((function(e){return'data:image/svg+xml;charset=utf-8,'+e}))}(r,t.width||n.width(e),t.height||n.height(e))}))}function l(e,t){return c(e,t).then(n.makeImage).then(n.delay(100)).then((function(r){var a=function(e){var r=document.createElement('canvas');if(r.width=t.width||n.width(e),r.height=t.height||n.height(e),t.bgcolor){var a=r.getContext('2d');a.fillStyle=t.bgcolor,a.fillRect(0,0,r.width,r.height)}return r}(e);return a.getContext('2d').drawImage(r,0,0),a}))}function u(e){return a.resolveAll().then((function(t){var n=document.createElement('style');return e.appendChild(n),n.appendChild(document.createTextNode(t)),e}))}function d(e){return o.inlineAll(e).then((function(){return e}))}1&&(e.exports=s)}()},function(e,t,n){var r=n(9)["default"],a=n(16);e.exports=function(e){var t=a(e,"string");return"symbol"===r(t)?t:String(t)},e.exports.__esModule=!0,e.exports["default"]=e.exports},function(e,t){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r},e.exports.__esModule=!0,e.exports["default"]=e.exports},function(e,t,n){var r=n(9)["default"];e.exports=function(e,t){if("object"!==r(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!==r(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)},e.exports.__esModule=!0,e.exports["default"]=e.exports},function(e,t,n){var r=n(9)["default"];function a(){"use strict";e.exports=a=function(){return t},e.exports.__esModule=!0,e.exports["default"]=e.exports;var t={},n=Object.prototype,o=n.hasOwnProperty,i=Object.defineProperty||function(e,t,n){e[t]=n.value},s="function"==typeof Symbol?Symbol:{},c=s.iterator||"@@iterator",l=s.asyncIterator||"@@asyncIterator",u=s.toStringTag||"@@toStringTag";function d(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{d({},"")}catch(e){d=function(e,t,n){return e[t]=n}}function p(e,t,n,r){var a=t&&t.prototype instanceof g?t:g,o=Object.create(a.prototype),s=new T(r||[]);return i(o,"_invoke",{value:P(e,n,s)}),o}function f(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=p;var h={};function g(){}function v(){}function m(){}var y={};d(y,c,(function(){return this}));var b=Object.getPrototypeOf,w=b&&b(b(E([])));w&&w!==n&&o.call(w,c)&&(y=w);var x=m.prototype=g.prototype=Object.create(y);function j(e){["next","throw","return"].forEach((function(t){d(e,t,(function(e){return this._invoke(t,e)}))}))}function S(e,t){var n;i(this,"_invoke",{value:function(a,i){function s(){return new t((function(n,s){!function n(a,i,s,c){var l=f(e[a],e,i);if("throw"!==l.type){var u=l.arg,d=u.value;return d&&"object"==r(d)&&o.call(d,"__await")?t.resolve(d.__await).then((function(e){n("next",e,s,c)}),(function(e){n("throw",e,s,c)})):t.resolve(d).then((function(e){u.value=e,s(u)}),(function(e){return n("throw",e,s,c)}))}c(l.arg)}(a,i,n,s)}))}return n=n?n.then(s,s):s()}})}function P(e,t,n){var r="suspendedStart";return function(a,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===a)throw o;return D()}for(n.method=a,n.arg=o;;){var i=n.delegate;if(i){var s=O(i,n);if(s){if(s===h)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var c=f(e,t,n);if("normal"===c.type){if(r=n.done?"completed":"suspendedYield",c.arg===h)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r="completed",n.method="throw",n.arg=c.arg)}}}function O(e,t){var n=t.method,r=e.iterator[n];if(void 0===r)return t.delegate=null,"throw"===n&&e.iterator["return"]&&(t.method="return",t.arg=void 0,O(e,t),"throw"===t.method)||"return"!==n&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+n+"' method")),h;var a=f(r,e.iterator,t.arg);if("throw"===a.type)return t.method="throw",t.arg=a.arg,t.delegate=null,h;var o=a.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,h):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,h)}function k(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function I(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function T(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(k,this),this.reset(!0)}function E(e){if(e){var t=e[c];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,r=function t(){for(;++n<e.length;)if(o.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return r.next=r}}return{next:D}}function D(){return{value:void 0,done:!0}}return v.prototype=m,i(x,"constructor",{value:m,configurable:!0}),i(m,"constructor",{value:v,configurable:!0}),v.displayName=d(m,u,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,m):(e.__proto__=m,d(e,u,"GeneratorFunction")),e.prototype=Object.create(x),e},t.awrap=function(e){return{__await:e}},j(S.prototype),d(S.prototype,l,(function(){return this})),t.AsyncIterator=S,t.async=function(e,n,r,a,o){void 0===o&&(o=Promise);var i=new S(p(e,n,r,a),o);return t.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},j(x),d(x,u,"Generator"),d(x,c,(function(){return this})),d(x,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=E,T.prototype={constructor:T,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(I),!e)for(var t in this)"t"===t.charAt(0)&&o.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(n,r){return i.type="throw",i.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var r=this.tryEntries.length-1;r>=0;--r){var a=this.tryEntries[r],i=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var s=o.call(a,"catchLoc"),c=o.call(a,"finallyLoc");if(s&&c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&o.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var a=r;break}}a&&("break"===e||"continue"===e)&&a.tryLoc<=t&&t<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=e,i.arg=t,a?(this.method="next",this.next=a.finallyLoc,h):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),h},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),I(n),h}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var a=r.arg;I(n)}return a}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:E(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),h}},t}e.exports=a,e.exports.__esModule=!0,e.exports["default"]=e.exports},function(e,t){function n(t,r){return e.exports=n=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},e.exports.__esModule=!0,e.exports["default"]=e.exports,n(t,r)}e.exports=n,e.exports.__esModule=!0,e.exports["default"]=e.exports},function(e,t,n){var r=n(15);e.exports=function(e){if(Array.isArray(e))return r(e)},e.exports.__esModule=!0,e.exports["default"]=e.exports},function(e,t){e.exports=function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)},e.exports.__esModule=!0,e.exports["default"]=e.exports},function(e,t,n){var r=n(15);e.exports=function(e,t){if(e){if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}},e.exports.__esModule=!0,e.exports["default"]=e.exports},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},e.exports.__esModule=!0,e.exports["default"]=e.exports},function(e,t){e.exports=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a},e.exports.__esModule=!0,e.exports["default"]=e.exports},function(e,t,n){"use strict";n.r(t);var r=n(1),a=n.n(r),o=n(3),i=n.n(o),s=n(0),c=n.n(s),l=n(5),u=n.n(l),d=n(6),p=n.n(d),f=n(2),h=n.n(f),g=n(7),v=n.n(g),m=n(8),y=n.n(m),b=n(4),w=n.n(b),x=n(11),j=n.n(x);function S(e,t){var n,r={second:1e3,minute:60*1e3,hour:60*1e3*60,day:24*60*1e3*60,week:7*24*60*1e3*60,month:30*24*60*1e3*60,year:365*24*60*1e3*60},a=Math.round,o=' ago',i=function(e,n){return void 0===t?"".concat(n," ").concat(e+(n>1?'s':'')+o):n+e.substring(0,1)},s=Date.now()-new Date(e).getTime();for(var c in s<0&&(j()("ts"),j()("dir")),r){if(a(s)<r[c])return i(n||'m',a(s/(r[n]||1)));n=c}return i(c,a(s/r[c]))}function P(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function O(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?P(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):P(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var k=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};u()(this,e),this.editor=t,this.$=t.$,this.pfx=t.getConfig('stylePrefix'),this.opts=n,this.setState=this.setState.bind(this),this.setStateSilent=this.setStateSilent.bind(this),this.onRender=this.onRender.bind(this),this.handleTabs=this.handleTabs.bind(this)}return p()(e,[{key:"setState",value:function(e){this.state=O(O({},this.state),e),this.update()}},{key:"setStateSilent",value:function(e){this.state=O(O({},this.state),e)}},{key:"sm",get:function(){return this.editor.Storage}},{key:"cs",get:function(){return this.editor.Storage.getCurrentStorage()}},{key:"pm",get:function(){return this.editor.Pages}},{key:"onRender",value:function(){}},{key:"handleTabs",value:function(){}}]),e}();function I(e){return T(e)/1024}function T(e){return(new TextEncoder).encode(JSON.stringify(e)).length}function E(e,t){return!(!t||!e)&&t.toLowerCase().indexOf(e.toLowerCase())>-1}function D(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function _(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?D(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):D(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function C(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=w()(e);if(t){var a=w()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return y()(this,n)}}var A=function(e){v()(d,e);var t,n,r,o,s,l=C(d);function d(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return u()(this,d),(t=l.call(this,e,n)).handleSort=t.handleSort.bind(h()(t)),t.handleFilterInput=t.handleFilterInput.bind(h()(t)),t.handleNameInput=t.handleNameInput.bind(h()(t)),t.handleOpen=t.handleOpen.bind(h()(t)),t.handleCreate=t.handleCreate.bind(h()(t)),t.handleDelete=t.handleDelete.bind(h()(t)),t.openEdit=t.openEdit.bind(h()(t)),t.handleCopy=t.handleCopy.bind(h()(t)),t.state={editableProjectId:'',projectId:'',tab:'pages',sites:[],nameText:'',filterText:'',loading:!1,sortBy:'published_at',sortOrder:'desc'},e.Modal.onceClose((function(){t.state.tab='pages'})),t}return p()(d,[{key:"editableId",get:function(){return this.state.editableProjectId}},{key:"allSites",get:function(){return this.state.sites}},{key:"allSitesSize",get:function(){return I(this.state.sites)}},{key:"onRender",value:(s=a()(c.a.mark((function e(){var t,n,r;return c.a.wrap((function(e){for(;1;)switch(e.prev=e.next){case 0:return t=this.setState,n=this.cs,t({loading:!0}),e.next=4,n.loadAll();case 4:r=e.sent,t({sites:r,loading:!1});case 6:case"end":return e.stop()}}),e,this)}))),function(){return s.apply(this,arguments)})},{key:"handleFilterInput",value:function(e){this.setState({filterText:e.target.value.trim()})}},{key:"handleNameInput",value:function(e){this.setStateSilent({nameText:e.target.value.trim()})}},{key:"handleSort",value:function(e){var t=this.state.sortOrder;e.target&&e.target.dataset&&this.setState({sortBy:e.target.dataset.sort,sortOrder:'desc'===t?'asc':'desc'})}},{key:"handleTabs",value:function(e){var t=e.target,n=this.$el,r=this.pfx,a=this.$;n.find(".".concat(r,"tablinks")).removeClass('active'),a(t).addClass('active'),'pages'===t.id?this.setState({tab:'pages'}):this.setState({tab:'templates'})}},{key:"handleOpen",value:(o=a()(c.a.mark((function e(t){var n,r,a,o;return c.a.wrap((function(e){for(;1;)switch(e.prev=e.next){case 0:if(n=this.editor,r=this.cs,(a=this.state.projectId)&&a!==r.currentId){e.next=5;break}return this.opts.currentPageOpen(),e.abrupt("return");case 5:return r.setId(a),e.next=8,n.load();case 8:o=e.sent,r.setName(o.name),r.setThumbnail(o.thumbnail||''),r.setIsTemplate(o.template),r.setDescription(o.description||'No description'),r.setGlobalSetting(o.globalSetting||''),n.Modal.close();case 15:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"handleCreate",value:(r=a()(c.a.mark((function e(t){var n,r,a,o,s,l,u,d,p,f,h;return c.a.wrap((function(e){for(;1;)switch(e.prev=e.next){case 0:if(r=this.editor,a=this.cs,o=this.state,s=o.projectId,l=o.nameText,u=r.runCommand('get-uuidv4'),d=l||'New-'+u.substring(0,8),n={id:u,name:d,template:!1,thumbnail:'',styles:'[]',description:'No description',globalSetting:'',pages:"[{\"id\": \"".concat(crypto.randomUUID().substring(0,13),"\", \"name\": \"index\"}]")},i()(n,"styles",'[]'),i()(n,"assets",'[]'),p=n,s){e.next=21;break}return a.setId(u),e.next=9,a.store(p);case 9:return a.setIsTemplate(!1),e.next=12,r.load();case 12:f=e.sent,a.setId(f.id),a.setName(f.name),a.setThumbnail(f.thumbnail||''),a.setDescription(f.description||'No description'),a.setGlobalSetting(f.globalSetting||''),r.Modal.close(),e.next=32;break;case 21:return a.setId(s),a.setIsTemplate(!1),e.next=25,r.load();case 25:h=e.sent,a.setId(u),a.setName(d),a.setThumbnail(h.thumbnail||''),a.setDescription(h.description||'No description'),a.setGlobalSetting(h.globalSetting||''),r.Modal.close();case 32:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"openEdit",value:function(e){var t=this.editor;(0,this.setStateSilent)({editableProjectId:e.currentTarget.dataset.id}),t.Modal.close(),t.SettingsApp.setTab('project'),t.runCommand('open-settings')}},{key:"handleCopy",value:(n=a()(c.a.mark((function e(t){var n,r,a,o,i,s,l,u,d,p,f;return c.a.wrap((function(e){for(;1;)switch(e.prev=e.next){case 0:if(n=this.cs,r=this.setState,a=this.opts,o=this.state,i=this.editor,s=t.currentTarget.dataset.id,l=o.sites.find((function(e){return e.id===s})),!a.confirmCopyProject()){e.next=23;break}return console.log(l),u=i.runCommand('get-uuidv4'),d=_(_({},l),{},{id:u,name:"".concat(l.name,"-copy")}),n.setId(u),e.next=10,n.store(d);case 10:return n.setIsTemplate(!1),e.next=13,i.load();case 13:return p=e.sent,n.setId(p.id),n.setName(p.name),n.setThumbnail(p.thumbnail||''),n.setDescription(p.description||'No description'),n.setGlobalSetting(p.globalSetting||''),e.next=21,n.loadAll();case 21:f=e.sent,r({sites:f});case 23:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"handleEdit",value:function(e){this.opts.onUpdateAsync(this.cs.update(_(_({},e),{},{updated_at:Date.now()})))}},{key:"handleDelete",value:(t=a()(c.a.mark((function e(t){var n,r,a,o,i;return c.a.wrap((function(e){for(;1;)switch(e.prev=e.next){case 0:if(n=this.cs,r=this.setState,!(a=this.opts).confirmDeleteProject()){e.next=10;break}return e.next=4,a.onDeleteAsync(n.delete(t.currentTarget.dataset.id));case 4:return o=e.sent,a.onDelete(o),e.next=8,n.loadAll();case 8:i=e.sent,r({sites:i});case 10:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"renderSiteList",value:function(){var e,t=this.state,n=t.sites,r=t.tab,a=t.filterText,o=t.loading,i=t.sortBy,s=t.sortOrder,c=this.pfx,l=this.opts,u=this.cs,d=this.editor;if(o)return l.loader||'<div>Loading sites...</div>';if(!n.length)return l.nosites||'<div style="padding: 10px 0;">No Sites</div>';'id'===i?e=function(e,t){return function(n,r){if('asc'===t){if(n[e]<r[e])return-1;if(n[e]>r[e])return 1}return n[e]>r[e]?-1:n[e]<r[e]?1:0}}(i,s):'updated_at'===i||'created_at'===i?e=function(e,t){return function(n,r){var a=new Date(n[e]).getTime(),o=new Date(r[e]).getTime();return'asc'===t?a-o:o-a}}(i,s):'pages'===i?e=function(e,t){return function(n,r){var a=JSON.parse(n[e]),o=JSON.parse(r[e]);if('desc'===t){if(a.length<o.length)return-1;if(a.length>o.length)return 1}return a.length>o.length?-1:a.length<o.length?1:0}}(i,s):'size'===i&&(e=function(e){return function(t,n){var r=I(t),a=I(n);if('asc'===e){if(r<a)return-1;if(r>a)return 1}return r>a?-1:r<a?1:0}}(s));var p=n.sort(e).filter((function(e){if(!a&&'pages'===r)return!0;var t=e.id,n=e.name,o=e.template;return!(!E(a,t)&&!E(a,n)||'pages'!==r)||!('templates'!==r||!o)})).map((function(e,t){var n=e.id,r=e.name,a=e.description,o=e.thumbnail,i=e.created_at,s=e.updated_at,p=I(e),f=e.pages?e.pages:l.legacyPrefix?e["".concat(l.legacyPrefix,"pages")]:[],h='string'==typeof f?JSON.parse(f):f,g=s?S(s):'NA',v=(i&&S(i),h.map((function(e){return e.name})).join(', '));return"<div \n                    class=\"site-wrapper ".concat(u.currentId===n?'open':'',"\" \n                    key=\"").concat(t,"\" \n                    data-id=\"").concat(n,"\" \n                    title=\"").concat(d.I18n.t('grapesjs-project-manager.templates.titles.open'),"\">\n                        <div class=\"site-screenshot\">\n                            <img src=\"").concat(o,"\" alt=\"\" />\n                        </div>\n                        <div class=\"site-info\">\n                            <h2>\n                                ").concat(r,"\n                            </h2>\n                            <div class=\"site-meta\">\n                                ").concat(a,"\n                            </div>\n                        </div>\n                        <div class=\"site-update-time\">").concat(g,"</div>\n                        <div class=\"site-pages\">\n                            <div title=\"").concat(v||n,"\">\n                                ").concat(h.length||1,"\n                            </div>\n                        </div>\n                        \n                        ").concat(l.size?"<div class=\"site-size\" title=\"".concat(p," KB\">\n                            ").concat(p.toFixed(2)," KB\n                        </div>"):'',"\n                        <div class=\"site-actions\">\n                            <i class=\"").concat(c,"caret-icon fa fa-copy copy\" title=\"").concat(d.I18n.t('grapesjs-project-manager.templates.titles.edit'),"\" data-id=\"").concat(n,"\"></i>\n                            <i class=\"").concat(c,"caret-icon fa fa-hand-pointer-o edit\" title=\"").concat(d.I18n.t('grapesjs-project-manager.templates.titles.edit'),"\" data-id=\"").concat(n,"\"></i>\n                            ").concat(u.currentId!==n?"<i class=\"".concat(c,"caret-icon fa fa-trash-o delete\" title=\"").concat(d.I18n.t('grapesjs-project-manager.templates.titles.delete'),"\" data-id=\"").concat(n,"\"></i>"):'',"\n                        </div>\n                    </div>")})).join('\n');if(!p.length){if('templates'===r)return l.nosites||'<div>No Templates Available.</div>';p="<div>\n                    <h3>\n                        No '".concat(a,"' examples found. Clear your search and try again.\n                    </h3>\n                </div>")}return p}},{key:"renderSiteTable",value:function(){var e=this.opts,t=this.editor;return'pages'===this.state.tab?"\n        <div id=\"site-table\">\n            <div class=\"site-wrapper-header\">\n                <div\n                    class=\"site-screenshot-header header\"\n                    data-sort=\"id\"\n                    title=\"".concat(t.I18n.t('grapesjs-project-manager.templates.titles.info'),"\"\n                >\n                    ").concat(t.I18n.t('grapesjs-project-manager.templates.info'),"\n                </div>\n                <div\n                    class=\"site-info header\"\n                    data-sort=\"id\"\n                ></div>\n                <div\n                    class=\"site-update-time header\"\n                    data-sort=\"updated_at\"\n                    title=\"").concat(t.I18n.t('grapesjs-project-manager.templates.titles.updated'),"\"\n                >\n                    ").concat(t.I18n.t('grapesjs-project-manager.templates.updated'),"\n                </div>\n                <div\n                    class=\"site-pages header\"\n                    data-sort=\"pages\"\n                    title=\"").concat(t.I18n.t('grapesjs-project-manager.templates.titles.pages'),"\"\n                >\n                    ").concat(t.I18n.t('grapesjs-project-manager.templates.pages'),"\n                </div>\n                \n                ").concat(e.size?"<div\n                    class=\"site-size header\"\n                    data-sort=\"size\"\n                    title=\"".concat(t.I18n.t('grapesjs-project-manager.templates.titles.size'),"\"\n                >\n                    ").concat(t.I18n.t('grapesjs-project-manager.templates.size'),"\n                </div>"):'',"\n                <div\n                    class=\"site-actions header\"\n                    data-sort=\"id\"\n                    title=\"").concat(t.I18n.t('grapesjs-project-manager.templates.titles.actions'),"\"\n                >\n                    ").concat(t.I18n.t('grapesjs-project-manager.templates.actions'),"\n                </div>\n            </div>\n            <div id=\"site-list\">\n                ").concat(this.renderSiteList(),"\n            </div>\n        </div>"):''}},{key:"renderSiteActions",value:function(){var e=this.editor;return'pages'===this.state.tab?"<div  class=\"flex-row\">\n                <input \n                    class=\"search tm-input\" \n                    placeholder=\"".concat(e.I18n.t('grapesjs-project-manager.templates.search'),"\"\n                />\n                <button id=\"open\" class=\"primary-button\">\n                    ").concat(e.I18n.t('grapesjs-project-manager.templates.open'),"\n                </button>\n            </div>"):"<div class=\"".concat(this.pfx,"tip-about ").concat(this.pfx,"four-color\">\n                ").concat(e.I18n.t('grapesjs-project-manager.templates.help'),"\n            </div>\n            <div class=\"flex-row\">\n                <input \n                    class=\"name tm-input\" \n                    placeholder=\"").concat(e.I18n.t('grapesjs-project-manager.templates.new'),"\"\n                />\n                <button id=\"create\" class=\"primary-button\">\n                    ").concat(e.I18n.t('grapesjs-project-manager.templates.create'),"\n                </button>\n            </div>")}},{key:"renderThumbnail",value:function(e,t){var n="<img src=\"".concat(e,"\" alt=\"\" />");return e?n:t.html?"<svg xmlns=\"http://www.w3.org/2000/svg\" class=\"template-preview\" viewBox=\"0 0 1300 1100\" width=\"99%\" height=\"220\">\n                <foreignObject width=\"100%\" height=\"100%\" style=\"pointer-events:none\">\n                    <div xmlns=\"http://www.w3.org/1999/xhtml\">\n                        ".concat(t.html+'<style scoped>'+t.css+'</style>',"\n                    </div>\n                </foreignObject>\n            </svg>"):n}},{key:"update",value:function(){var e,t,n,r,a,o,i,s,c,l,u,d=this;null===(e=this.$el)||void 0===e||e.find('#site-table').html(this.renderSiteTable()),null===(t=this.$el)||void 0===t||t.find('#site-list').html(this.renderSiteList()),null===(n=this.$el)||void 0===n||n.find('#tm-actions').html(this.renderSiteActions());var p=null===(r=this.$el)||void 0===r?void 0:r.find('.site-wrapper'),f=null===(a=this.$el)||void 0===a?void 0:a.find('input.search'),h=null===(o=this.$el)||void 0===o?void 0:o.find('input.name');this.setStateSilent({projectId:''}),p&&p.on('click',(function(e){p.removeClass('selected'),d.$(e.currentTarget).addClass('selected'),d.setStateSilent({projectId:e.currentTarget.dataset.id})})),f&&(f.val(this.state.filterText),f.on('change',this.handleFilterInput)),h&&(h.val(this.state.nameText),h.on('change',this.handleNameInput)),null===(i=this.$el)||void 0===i||i.find('#open').on('click',this.handleOpen),null===(s=this.$el)||void 0===s||s.find('#create').on('click',this.handleCreate),null===(c=this.$el)||void 0===c||c.find('i.edit').on('click',this.openEdit),null===(l=this.$el)||void 0===l||l.find('i.copy').on('click',this.handleCopy),null===(u=this.$el)||void 0===u||u.find('i.delete').on('click',this.handleDelete)}},{key:"render",value:function(){var e,t=this.$,n=this.pfx,r=this.editor,a=this.state.tab;this.onRender(),null===(e=this.$el)||void 0===e||e.remove();var o=t("<div class=\"app\">\n                <div class=\"contents\">\n                    <div class=\"".concat(n,"tab\">\n                        <button id=\"pages\" class=\"").concat(n,"tablinks ").concat('pages'===a?'active':'',"\">\n                            ").concat(r.I18n.t('grapesjs-project-manager.templates.all'),"\n                        </button>\n                        <button id=\"templates\" class=\"").concat(n,"tablinks ").concat('templates'===a?'active':'',"\"\">\n                            ").concat(r.I18n.t('grapesjs-project-manager.templates.newTemplates'),"\n                        </button>\n                    </div>\n                    <div id=\"tm-actions\">\n                        ").concat(this.renderSiteActions(),"\n                    </div>\n                    ").concat(this.renderSiteTable(),"\n                </div>\n            </div>"));return o.find('.header').on('click',this.handleSort),o.find('#pages, #templates').on('click',this.handleTabs),this.$el=o,o}}]),d}(k),M=n(12),L=n.n(M);function N(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=w()(e);if(t){var a=w()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return y()(this,n)}}var R=function(e){v()(n,e);var t=N(n);function n(e){var r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return u()(this,n),(r=t.call(this,e,a)).addPage=r.addPage.bind(h()(r)),r.selectPage=r.selectPage.bind(h()(r)),r.copyPage=r.copyPage.bind(h()(r)),r.removePage=r.removePage.bind(h()(r)),r.isSelected=r.isSelected.bind(h()(r)),r.openEdit=r.openEdit.bind(h()(r)),r.state={editablePageId:'',isShowing:!0,pageInfo:{name:'',title:'',keywords:'',description:'',pageSetting:''},pages:[],loading:!1},r}return p()(n,[{key:"editableId",get:function(){return this.state.editablePageId}},{key:"onRender",value:function(){var e=this.pm,t=this.setState,n=this.editor;t({loading:!0}),t({pages:L()(e.getAll())}),n.on('page',(function(){t({pages:L()(e.getAll())})})),t({loading:!1})}},{key:"isSelected",value:function(e){return this.pm.getSelected().id===e.id}},{key:"selectPage",value:function(e){this.pm.select(e.currentTarget.dataset.key),this.update()}},{key:"copyPage",value:function(e){var t=e.currentTarget.dataset.key,n=this.pm,r=n.get(t),a=r.getMainComponent(),o=r.get('name')||t;n.add({name:"".concat(o,"-copy"),component:a}),this.update()}},{key:"removePage",value:function(e){this.opts.confirmDeleteProject()&&(this.pm.remove(e.currentTarget.dataset.key),this.update())}},{key:"openEdit",value:function(e){var t=this.editor;this.setStateSilent({editablePageId:e.currentTarget.dataset.key}),t.Modal.close(),t.SettingsApp.setTab('page'),t.runCommand('open-settings')}},{key:"editPage",value:function(e,t){var n=t.name,r=t.title,a=t.keywords,o=t.description,i=t.pageSetting,s=this.pm.get(e);null==s||s.set('name',n),null==s||s.set('title',r),null==s||s.set('keywords',a),null==s||s.set('description',o),null==s||s.set('pageSetting',i),this.update()}},{key:"addPage",value:function(){var e=this.pm,t=this.state.pageInfo.name;t&&(e.add({name:t,component:''}),this.update())}},{key:"renderPagesList",value:function(){var e=this.state,t=e.pages,n=e.loading,r=this.opts,a=this.isSelected;return n?r.loader||'<div>Loading pages...</div>':t.map((function(e,t){return"<div \n                data-id=\"".concat(t,"\" \n                data-key=\"").concat(e.get('private')?'':e.id||e.get('name'),"\"  \n                class=\"page ").concat(a(e)?'selected':'',"\"\n            >\n                <i class=\"fa fa-file-o\" style=\"margin:5px;\"></i>\n                <div class=\"page-title\">").concat(e.get('name')||e.id,"</div>\n                <div class=\"page-oper\">\n                    ").concat(e.get('internal')?'':"<span class=\"page-edit\" data-key=\"".concat(e.id||e.get('name'),"\"><i class=\"fa fa-hand-pointer-o\"></i></span>"),"\n                    ").concat(e.get('internal')?'':"<span class=\"page-copy\" data-key=\"".concat(e.id||e.get('name'),"\"><i class=\"fa fa-copy\"></i></span>"),"\n                    ").concat(a(e)||e.get('internal')?'':"<span class=\"page-close\" data-key=\"".concat(e.id||e.get('name'),"\">&Cross;</span>"),"\n                </div>\n            </div>")})).join("\n")}},{key:"update",value:function(){var e,t,n,r,a;null===(e=this.$el)||void 0===e||e.find('.pages').html(this.renderPagesList()),null===(t=this.$el)||void 0===t||t.find('.page').on('click',this.selectPage),null===(n=this.$el)||void 0===n||n.find('.page-edit').on('click',this.openEdit),null===(r=this.$el)||void 0===r||r.find('.page-copy').on('click',this.copyPage),null===(a=this.$el)||void 0===a||a.find('.page-close').on('click',this.removePage)}},{key:"render",value:function(){var e,t=this.$,n=this.editor;this.onRender(),null===(e=this.$el)||void 0===e||e.remove();var r=t("<div style=\"display: ".concat(this.state.isShowing?'flex':'none',";\" class=\"pages-wrp\">\n                <div class=\"pages\">\n                    ").concat(this.renderPagesList(),"\n                </div>\n                <div  class=\"flex-row\">\n                    <input \n                        class=\"tm-input sm\" \n                        type=\"text\" \n                        placeholder=\"").concat(n.I18n.t('grapesjs-project-manager.pages.placeholder'),"\" \n                    />\n                </div>\n                <div class=\"add-page\">\n                    ").concat(n.I18n.t('grapesjs-project-manager.pages.new'),"\n                </div>\n            </div>"));return r.find('.add-page').on('click',this.addPage),this.$el=r,r}},{key:"findPanel",get:function(){return this.editor.Panels.getPanel('views-container')}},{key:"showPanel",value:function(){var e;this.state.isShowing=!0,null===(e=this.findPanel)||void 0===e||e.set('appendContent',this.render()).trigger('change:appendContent'),this.update()}},{key:"hidePanel",value:function(){this.state.isShowing=!1,this.render()}}]),n}(k);function $(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=w()(e);if(t){var a=w()(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return y()(this,n)}}var B=function(e){v()(n,e);var t=$(n);function n(e){var r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return u()(this,n),(r=t.call(this,e,a)).handleSave=r.handleSave.bind(h()(r)),r.handleThumbnail=r.handleThumbnail.bind(h()(r)),r.handleThumbnailInput=r.handleThumbnailInput.bind(h()(r)),r.state={tab:'page',loading:!1},r}return p()(n,[{key:"setTab",value:function(e){this.state.tab=e}},{key:"update",value:function(){var e=this.$el;null==e||e.find('#settings').html(this.renderSettings()),null==e||e.find('#generate').on('click',this.handleThumbnail),null==e||e.find('input#thumbnail').on('change',this.handleThumbnailInput)}},{key:"onRender",value:function(){var e=this.setState;e({loading:!0}),e({loading:!1})}},{key:"handleSave",value:function(e){var t=this.$el,n=this.editor;if('page'===this.state.tab){var r=n.PagesApp.editableId,a=null==t?void 0:t.find('input.name').val().trim(),o=null==t?void 0:t.find('input.title').val().trim(),i=null==t?void 0:t.find('textarea.keywords').val().trim(),s=null==t?void 0:t.find('textarea.description').val().trim(),c=null==t?void 0:t.find('textarea.pageSetting').val().trim();r&&n.PagesApp.editPage(r,{name:a,title:o,keywords:i,description:s,pageSetting:c})}else{var l=n.TemplateManager.editableId,u=null==t?void 0:t.find('input.thumbnail').val().trim(),d=null==t?void 0:t.find('input.name').val().trim(),p=null==t?void 0:t.find('input.desc').val().trim(),f=null==t?void 0:t.find('textarea.globalSetting').val().trim();l&&n.TemplateManager.handleEdit({id:l,thumbnail:u,name:d,description:p,template:!1,globalSetting:f})}n.Modal.close()}},{key:"handleThumbnail",value:function(e){var t=this.editor,n=this.$el,r=this.opts;t.runCommand('take-screenshot',{clb:function(e){null==n||n.find('img').attr('src',e),r.onThumbnail(e,null==n?void 0:n.find('input.thumbnail'))}})}},{key:"handleThumbnailInput",value:function(e){var t;null===(t=this.$el)||void 0===t||t.find('img').attr('src',e.target.value.trim())}},{key:"renderSettings",value:function(){var e=this.state,t=e.tab,n=e.loading,r=this.opts,a=this.pfx,o=this.pm,i=this.editor;if(n)return r.loader||'<div>Loading settings...</div>';if('page'===t){var s=o.get(i.PagesApp.editableId);console.log(s);var c=(null==s?void 0:s.get('name'))||(null==s?void 0:s.id)||'',l=(null==s?void 0:s.get('title'))||'',u=(null==s?void 0:s.get('keywords'))||'',d=(null==s?void 0:s.get('description'))||'',p=(null==s?void 0:s.get('pageSetting'))||'';return"<label for=\"name\">\n                    ".concat(i.I18n.t('grapesjs-project-manager.settings.labels.name'),"\n                </label>\n                <div class=\"flex-row\">\n                    <input \n                        class=\"name tm-input\" \n                        value=\"").concat(c,"\" \n                        placeholder=\"").concat(i.I18n.t('grapesjs-project-manager.settings.placeholders.name'),"\"/>\n                </div>\n                <label for=\"title\">\n                    ").concat(i.I18n.t('grapesjs-project-manager.settings.labels.title'),"\n                </label>\n                <div class=\"flex-row\">\n                    <input \n                        class=\"title tm-input\" \n                        value=\"").concat(l,"\" \n                        placeholder=\"").concat(i.I18n.t('grapesjs-project-manager.settings.placeholders.title'),"\"/>\n                </div>\n                <label for=\"keywords\">\n                    ").concat(i.I18n.t('grapesjs-project-manager.settings.labels.keywords'),"\n                </label>\n                <div class=\"flex-row\">\n                    <textarea \n                        class=\"keywords tm-input\" \n                        placeholder=\"").concat(i.I18n.t('grapesjs-project-manager.settings.placeholders.keywords'),"\">").concat(u,"</textarea>\n                </div>\n                <label for=\"description\">\n                    ").concat(i.I18n.t('grapesjs-project-manager.settings.labels.description'),"\n                </label>\n                <div class=\"flex-row\">\n                    <textarea \n                        class=\"description tm-input\" \n                        placeholder=\"").concat(i.I18n.t('grapesjs-project-manager.settings.placeholders.description'),"\">").concat(d,"</textarea>\n                </div>\n                <label for=\"pageSetting\">\n                    ").concat(i.I18n.t('grapesjs-project-manager.settings.labels.pageSetting'),"\n                </label>\n                <div class=\"flex-row\">\n                    <textarea \n                        class=\"pageSetting tm-input\" \n                        placeholder=\"").concat(i.I18n.t('grapesjs-project-manager.settings.placeholders.pageSetting'),"\">").concat(p,"</textarea>\n                </div>")}var f=i.TemplateManager.allSites.find((function(e){return e.id===i.TemplateManager.editableId}));return"<div class=\"".concat(a,"tip-about ").concat(a,"four-color\">\n                    ").concat(i.I18n.t('grapesjs-project-manager.settings.help'),"\n                </div>\n                <label for=\"thumbnail\">\n                    ").concat(i.I18n.t('grapesjs-project-manager.settings.labels.thumbnail'),"\n                </label>\n                <div class=\"flex-row\">\n                    <input \n                        id=\"thumbnail\" \n                        class=\"thumbnail tm-input\" \n                        value=\"").concat((null==f?void 0:f.thumbnail)||'',"\" \n                        placeholder=\"").concat(i.I18n.t('grapesjs-project-manager.settings.placeholders.thumbnail'),"\"\n                    />\n                </div>\n                <div class=\"flex-row\" style=\"margin-bottom:15px;\">\n                    <div class=\"site-screenshot\">\n                        <img src=\"").concat((null==f?void 0:f.thumbnail)||'',"\" alt=\"screenshot\" />\n                    </div>\n                    <button id=\"generate\" class=\"primary-button\">\n                        ").concat(i.I18n.t('grapesjs-project-manager.settings.generate'),"\n                    </button>\n                </div>\n                <label for=\"name\">\n                    ").concat(i.I18n.t('grapesjs-project-manager.settings.labels.name'),"\n                </label>\n                <div class=\"flex-row\">\n                    <input \n                        id=\"name\" \n                        class=\"name tm-input\" \n                        value=\"").concat((null==f?void 0:f.name)||'',"\" \n                        placeholder=\"").concat(i.I18n.t('grapesjs-project-manager.settings.placeholders.name'),"\"\n                    />\n                </div>\n                <label for=\"desc\">\n                    ").concat(i.I18n.t('grapesjs-project-manager.settings.labels.description'),"\n                </label>\n                <div class=\"flex-row\">\n                    <input \n                        id=\"desc\" \n                        class=\"desc tm-input\" \n                        value=\"").concat((null==f?void 0:f.description)||'',"\" \n                        placeholder=\"").concat(i.I18n.t('grapesjs-project-manager.settings.placeholders.description'),"\"\n                    />\n                </div>\n                \n                <label for=\"desc\">\n                    ").concat(i.I18n.t('grapesjs-project-manager.settings.labels.globalSetting'),"\n                </label>\n                <div class=\"flex-row\">\n                    <textarea \n                        id=\"desc\" \n                        class=\"globalSetting tm-input\" \n                        placeholder=\"").concat(i.I18n.t('grapesjs-project-manager.settings.placeholders.globalSetting'),"\"\n                    >").concat((null==f?void 0:f.globalSetting)||'',"</textarea>\n                </div>")}},{key:"render",value:function(){var e,t=this.$,n=this.editor;this.onRender(),null===(e=this.$el)||void 0===e||e.remove();var r=t("<div class=\"app\">\n                <div id=\"settings\">\n                    ".concat(this.renderSettings(),"\n                </div>\n                <div class=\"flex-row\">\n                    <button id=\"save\" class=\"primary-button\">\n                        ").concat(n.I18n.t('grapesjs-project-manager.settings.save'),"\n                    </button>\n                </div>\n            </div>"));return r.find('#save').on('click',this.handleSave),r.find('#generate').on('click',this.handleThumbnail),r.find('input#thumbnail').on('change',this.handleThumbnailInput),this.$el=r,r}}]),n}(k),z=A,U=n(13),F=n.n(U);function G(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function V(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?G(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):G(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var W=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.Commands,r=e.Storage.getCurrentStorage(),o=e.Modal,i=e.getConfig('stylePrefix'),s="".concat(i,"mdl-dialog-tml"),l="".concat(i,"mdl-dialog-md");e.domtoimage=F.a,n.add('open-templates',{run:function(e,n){var r=document.querySelector(".".concat(i,"mdl-dialog"));r.classList.add(s),(null==n?void 0:n.set)&&n.set('active'),o.setTitle(t.mdlTitle),o.setContent(e.TemplateManager.render()),o.open(),o.getModel().once('change:open',(function(){r.classList.remove(s)}))}}),n.add('open-settings',{run:function(e,n){var r=document.querySelector(".".concat(i,"mdl-dialog"));r.classList.add(l),(null==n?void 0:n.set)&&n.set('active'),o.setTitle(t.mdlTitle),o.setContent(e.SettingsApp.render()),o.open(),o.getModel().once('change:open',(function(){r.classList.remove(l)}))}}),n.add('open-pages',{run:function(e){e.PagesApp.showPanel()},stop:function(e){e.PagesApp.hidePanel()}});var u=function(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(function(e){return(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)}))},d=function(){var e=a()(c.a.mark((function e(n){var r,a,o,i,s=arguments;return c.a.wrap((function(e){for(;1;)switch(e.prev=e.next){case 0:return r=s.length>1&&void 0!==s[1]?s[1]:{},a=s.length>2?s[2]:void 0,o=s.length>3?s[3]:void 0,e.prev=3,e.next=6,t.onScreenshotAsync(F.a.toJpeg(n,r));case 6:i=e.sent,a&&a(i),e.next=13;break;case 10:e.prev=10,e.t0=e["catch"](3),o&&o(e.t0);case 13:case"end":return e.stop()}}),e,null,[[3,10]])})));return function(t){return e.apply(this,arguments)}}();n.add('get-uuidv4',(function(){if(crypto)return crypto.randomUUID?crypto.randomUUID():u()})),n.add('take-screenshot',(function(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{clb:function(e){return e}},a=e.getWrapper().getEl();d(a,{quality:t.quality,height:1e3,cacheBust:!0,style:V({'background-color':'white'},e.getWrapper().getStyle())},r.clb,t.onScreenshotError)})),n.add('save-as-template',(function(e){r.setIsTemplate(!0),e.store()})),n.add('delete-template',function(){var e=a()(c.a.mark((function e(n){var a;return c.a.wrap((function(e){for(;1;)switch(e.prev=e.next){case 0:return e.next=2,r.delete();case 2:a=e.sent,t.onDelete(a);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},H=n(10),q=n.n(H),K='indexeddb',X='rest-api',J='firestore',Y={currentName:'Default',currentId:'uuidv4',currentThumbnail:'',isTemplate:!1,description:'No description',globalSetting:'',setId:function(e){this.currentId=e},setName:function(e){this.currentName=e},setThumbnail:function(e){this.currentThumbnail=e},setGlobalSetting:function(e){this.globalSetting=e},setIsTemplate:function(e){this.isTemplate=!!e},setDescription:function(e){this.description=e}},Z=["id"];function Q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ee(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Q(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Q(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var te=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.StorageManager,o=K,i=n.objectStoreName,s=function(){return t},l=function(){return new Promise((function(e,r){if(t)e(t);else{var a=(window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB).open(n.dbName,n.indexeddbVersion);a.onerror=r,a.onsuccess=function(){(t=a.result).onerror=r,e(t)},a.onupgradeneeded=function(e){a.result.createObjectStore(i,{keyPath:'id'}).createIndex('name','name',{unique:!1})}}}))},u=function(){return t.transaction([i],'readwrite').objectStore(i)},d=function(){var e=a()(c.a.mark((function e(){return c.a.wrap((function(e){for(;1;)switch(e.prev=e.next){case 0:if(!t){e.next=4;break}return e.abrupt("return",u());case 4:return e.next=6,l();case 6:return e.abrupt("return",u());case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();r.add(o,ee(ee({},Y),{},{getDb:s,getObjectStore:u,load:function(e){var t=this;return a()(c.a.mark((function e(){var n;return c.a.wrap((function(e){for(;1;)switch(e.prev=e.next){case 0:return e.next=2,d();case 2:return n=e.sent,e.abrupt("return",new Promise((function(e,r){var a=n.get(t.currentId);a.onerror=r,a.onsuccess=function(){e(a.result||{})}})));case 4:case"end":return e.stop()}}),e)})))()},loadAll:function(){return a()(c.a.mark((function e(){var t;return c.a.wrap((function(e){for(;1;)switch(e.prev=e.next){case 0:return e.next=2,d();case 2:return t=e.sent,e.abrupt("return",new Promise((function(e,n){var r=t.getAll();r.onerror=n,r.onsuccess=function(){e(r.result||[])}})));case 4:case"end":return e.stop()}}),e)})))()},store:function(e){var t=this;return a()(c.a.mark((function n(){var r;return c.a.wrap((function(n){for(;1;)switch(n.prev=n.next){case 0:return n.next=2,d();case 2:return r=n.sent,n.abrupt("return",new Promise((function(n,a){var o=r.put(ee({id:t.currentId,name:t.currentName,template:t.isTemplate,thumbnail:t.currentThumbnail,description:t.description,globalSetting:t.globalSetting,updated_at:Date.now()},e));o.onerror=a,o.onsuccess=function(){n(o.result)}})));case 4:case"end":return n.stop()}}),n)})))()},update:function(e){return a()(c.a.mark((function t(){var n,r,a;return c.a.wrap((function(t){for(;1;)switch(t.prev=t.next){case 0:return n=e.id,r=q()(e,Z),t.next=3,d();case 3:return a=t.sent,t.abrupt("return",new Promise((function(e,t){var o=a.get(n);o.onerror=t,o.onsuccess=function(){a.put(ee(ee({id:n},o.result),r)),e(o.result)}})));case 5:case"end":return t.stop()}}),t)})))()},delete:function(e){var t=this;return a()(c.a.mark((function n(){var r;return c.a.wrap((function(n){for(;1;)switch(n.prev=n.next){case 0:return n.next=2,d();case 2:return r=n.sent,n.abrupt("return",new Promise((function(n,a){var o=r.delete(e||t.currentId);o.onerror=a,o.onsuccess=function(){n(o.result)}})));case 4:case"end":return n.stop()}}),n)})))()}}))};function ne(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function re(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ne(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ne(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ae=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.StorageManager,r=X,o=n.get('remote'),i=n.getStorageOptions('remote');n.add(r,re(re({},Y),{},{load:function(){var e=arguments,t=this;return a()(c.a.mark((function n(){var r,a,s,l;return c.a.wrap((function(n){for(;1;)switch(n.prev=n.next){case 0:return r=e.length>0&&void 0!==e[0]?e[0]:{},a=i.urlLoad,s=a.endsWith('/')?t.currentId:"/".concat(t.currentId),n.next=5,o.load(re(re(re({},i),{urlLoad:a+s}),r));case 5:return l=n.sent,n.abrupt("return",l);case 7:case"end":return n.stop()}}),n)})))()},loadAll:function(){var e=arguments;return a()(c.a.mark((function t(){var n;return c.a.wrap((function(t){for(;1;)switch(t.prev=t.next){case 0:return n=e.length>0&&void 0!==e[0]?e[0]:{},t.next=3,o.load(re(re({},i),n));case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)})))()},store:function(e){var n=arguments,r=this;return a()(c.a.mark((function a(){var s,l,u,d;return c.a.wrap((function(a){for(;1;)switch(a.prev=a.next){case 0:return s=n.length>1&&void 0!==n[1]?n[1]:{},l=i.urlStore,u=l.endsWith('/')?r.currentId:"/".concat(r.currentId),a.next=5,o.store(re({id:r.currentId,name:r.currentName,template:r.isTemplate,thumbnail:r.currentThumbnail,description:r.description,globalSetting:r.globalSetting,updated_at:Date.now()},e),re(re(re({},i),{urlStore:t.uuidInPath?l+u:l}),s));case 5:return d=a.sent,a.abrupt("return",d);case 7:case"end":return a.stop()}}),a)})))()},update:function(e){return a()(c.a.mark((function t(){var n,r,a;return c.a.wrap((function(t){for(;1;)switch(t.prev=t.next){case 0:return n=i.urlStore,r=e.id,r=n.endsWith('/')?r:"/".concat(r),t.next=5,o.store(e,re(re(re({},i),{urlStore:n+r}),keys));case 5:return a=t.sent,t.abrupt("return",a);case 7:case"end":return t.stop()}}),t)})))()},delete:function(e){var t=this;return a()(c.a.mark((function n(){var r,a,s;return c.a.wrap((function(n){for(;1;)switch(n.prev=n.next){case 0:return r=i.urlDelete,a=e||t.currentId,a=r.endsWith('/')?a:"/".concat(a),n.next=5,o.request(r+a,{method:'delete'});case 5:return s=n.sent,n.abrupt("return",s);case 7:case"end":return n.stop()}}),n)})))()}}))},oe=["id"];function ie(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function se(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ie(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ie(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var ce=function(e){var t,n,r,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=e.StorageManager,s=J,l=o.apiKey,u=o.authDomain,d=o.projectId,p=o.settings,f=function(e){return i.onError(s,e.code||e)},h=function(){return n},g=function(){return r||(firebase.apps.length?(firebase.app(),(t=firebase.firestore()).settings(p)):(firebase.initializeApp(se({apiKey:l,authDomain:u,projectId:d},o.firebaseConfig)),(t=firebase.firestore()).settings(p)),o.enableOffline&&t.enablePersistence().catch(f),r=t.collection(o.objectStoreName))},v=function(){var t=g(),r=e.Storage.getCurrentStorage();return n=t.doc(r.currentId)};i.add(s,se(se({},Y),{},{getDoc:h,setDocId:function(e){this.currentId=e},load:function(e){return a()(c.a.mark((function e(){var t,n;return c.a.wrap((function(e){for(;1;)switch(e.prev=e.next){case 0:return t=v(),e.next=3,t.get();case 3:return n=e.sent,e.abrupt("return",n.exists?n.data():{});case 5:case"end":return e.stop()}}),e)})))()},loadAll:function(){return a()(c.a.mark((function e(){var t,n,r;return c.a.wrap((function(e){for(;1;)switch(e.prev=e.next){case 0:return t=g(),e.next=3,t.get();case 3:return n=e.sent,r=[],n.forEach((function(e){return r.push(e.data())})),e.abrupt("return",r);case 7:case"end":return e.stop()}}),e)})))()},store:function(e){var t=this;return a()(c.a.mark((function n(){var r;return c.a.wrap((function(n){for(;1;)switch(n.prev=n.next){case 0:return r=g(),n.next=3,r.doc(e.id||t.currentId).set(se({id:t.currentId,name:t.currentName,template:t.isTemplate,thumbnail:t.currentThumbnail,description:t.description,globalSetting:t.globalSetting,updated_at:Date.now()},e));case 3:case"end":return n.stop()}}),n)})))()},update:function(e){return a()(c.a.mark((function t(){var n,r,a;return c.a.wrap((function(t){for(;1;)switch(t.prev=t.next){case 0:return n=e.id,r=q()(e,oe),a=g(),t.next=4,a.doc(n).set(r,{merge:!0});case 4:case"end":return t.stop()}}),t)})))()},delete:function(e){return a()(c.a.mark((function t(){var n,r;return c.a.wrap((function(t){for(;1;)switch(t.prev=t.next){case 0:if(e){t.next=6;break}return n=v(),t.next=4,n.delete();case 4:t.next=9;break;case 6:return r=g(),t.next=9,r.doc(e).delete();case 9:case"end":return t.stop()}}),t)})))()}}))},le=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};te(e,t),ae(e,t),ce(e,t)},ue={'grapesjs-project-manager':{templates:{all:'All',newTemplates:'New Site',search:'Search for sites by name or id',open:'Open',new:'Enter new site name',create:'Create',help:'Select a site, enter project name, then click create. If no site is selected a blank project will be created.',info:'Site Info',updated:'Last Updated',pages:'Pages',created:'Created At',size:'Size',actions:'Actions',titles:{open:'Select to open site',info:'Click to sort by site name',updated:'Click to sort by last update date',pages:'Click to sort by number of pages',created:'Click to sort by site creation date',size:'Click to sort by site size',actions:'Click to sort by site name',delete:'Delete',edit:'Edit'}},pages:{placeholder:'page name',new:'New Page +'},settings:{save:'Save',generate:'Generate',help:'Enter url, or generate thumbnail.',labels:{name:'Name',thumbnail:'Thumbnail',description:'Description',template:'Template',keywords:'Keywords',title:'Title',pageSetting:'Page Setting',globalSetting:'Global Setting'},placeholders:{name:'Name...',thumbnail:'Thumbnail...',description:'Description...',keywords:'Keywords...',title:'Title...',pageSetting:'Page Setting...',globalSetting:'Global Setting...'}}}},de=function(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=e.$,o=e.Devices,i=a("<div class=\"iframe-handle-container hidden\">\n        <div class=\"handle right-handle\">\n            <div class=\"gutter-handle\"></div>\n            <div class=\"tab-handle\"></div>\n            <div class=\"dim-indicator\"></div>\n        </div>\n        <div class=\"handle left-handle\"></div>\n    </div>");e.Commands.add('smoothresize',(function(){})),e.on('change:device',(function(){t||(t=a('.gjs-frame-wrapper')),t.css({width:'',transition:'width 0.35s ease,height 0.35s ease'}),i.find('.dim-indicator').css('display','none'),i.css('display','none'),setTimeout((function(){var n=o.get(e.getDevice());s(n),c(n),l(),i.css('display','block'),t.css('transition','none')}),800)})),e.on('run:preview',(function(){return i.css('display','none')})),e.on('stop:preview',(function(){return i.css('display','block')})),e.Canvas.model.on('change:zoom',(function(){r.hideOnZoom&&(100===e.Canvas.getZoom()?i.css('display','block'):i.css('display','none'))}));var s=function(e){var n=i;if(n.length>0)n.addClass('hidden');else{t||(t=a('.gjs-frame-wrapper'));var r=i.clone(!0,!0);t.before(r)}setTimeout((function(){a(window).trigger('resize')}),600)},c=function(o){try{var s=parseInt(o.get('widthMedia'),10),c=0,l=0;pe(i.find('.right-handle').get(0),{axis:'x',max:s,min:r.minScreenSize,start:function(){c=e.Canvas.getFrameEl().offsetWidth},drag:function(o){try{n||(n=a('.gjs-cv-canvas')),0===n.find('.handle-mask').length&&n.append('<div class="handle-mask" style="position: absolute; z-index: 2; left: 0; top: 0; right: 0; bottom: 0;"></div>');var u=o-e.Canvas.getOffset().left-c,d=c+u*r.dragDampen,p=e.Canvas.getOffset().left,f=!0;if(d>s||d<r.minScreenSize)o=l,f=!1;else{l=o,t||(t=a('.gjs-frame-wrapper')),console.log(t,d),t.css('width',d),i.find('.left-handle').css('left',p);var h=p-162;i.find('.device-resolution').css('left',h),i.find('.dim-indicator').html('Screen size  '+Math.round(d)+'px'),i.find('.dim-indicator').css('display','block')}return e.refresh(),f}catch(e){return console.error(e),!1}},stop:function(){try{a('.handle-mask').remove(),e.runCommand('smoothresize')}catch(e){console.error(e)}}})}catch(e){console.error(e)}};e.on('load',(function(){a('.gjs-cv-canvas').append(i),l()}));var l=function(){var t=document,n=window,r=t.compatMode&&'CSS1Compat'===t.compatMode?t.documentElement:t.body,a=r.clientWidth,o=r.clientHeight;n.innerWidth&&a>n.innerWidth&&(a=n.innerWidth,o=n.innerHeight);var s=i;if(s.length>0){var c=s.find('.left-handle'),l=s.find('.right-handle'),u=e.Canvas.getOffset().left,d=e.Canvas.getOffset().left+e.Canvas.getFrameEl().offsetWidth;c.css('cssText','left: '+u+'px !important'),l.css('cssText','left: '+d+'px !important'),s.removeClass('hidden')}return{width:a,height:o}}},pe=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=0,r=0,a=0,o=0,i=5,s=0,c=0;e.addEventListener('mousedown',(function(e){(e=e||window.event).preventDefault(),a=e.clientX,o=e.clientY,document.onmouseup=u,document.onmousemove=l,t.start()}));var l=function(l){(l=l||window.event).preventDefault(),n=a-l.clientX,r=o-l.clientY,a=l.clientX,o=l.clientY,'x'!==t.axis&&'xy'!==t.axis||(e.style.left=e.offsetLeft-n+'px',t.drag(e.offsetLeft)||(s?(e.style.left=e.offsetLeft+n+Math.sign(n)*i+'px',s=0):(e.style.left=e.offsetLeft+n+'px',s++))),'y'!==t.axis&&'xy'!==t.axis||(e.style.top=e.offsetTop-r+'px',t.drag(e.offsetTop)||(c?(e.style.top=e.offsetTop+r+Math.sign(r)*i+'px',c=0):(e.style.top=e.offsetTop+r+'px',c++)))},u=function(){document.onmouseup=null,document.onmousemove=null,t.stop()}};function fe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function he(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?fe(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}t["default"]=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=he(he({},{legacyPrefix:'',dbName:'gjs',objectStoreName:'projects',loadFirst:!0,customLoad:!1,uuidInPath:!0,indexeddbVersion:6,confirmDeleteProject:function(){return confirm('Are you sure to delete this project')},confirmCopyProject:function(){return confirm('Are you sure copy this project')},confirmDeletePage:function(){return confirm('Are you sure to delete this page')},onDelete:function(e){console.log('Deleted:',e)},onDeleteAsync:function(e){return e},onUpdateAsync:function(e){return e},onScreenshotAsync:function(e){return e},onScreenshotError:function(e){console.log(e)},onThumbnail:function(e,t){t.val(e)},quality:.01,mdlTitle:'Project Manager',nopages:'<div style="display:flex;align-items:center;padding:50px;margin:auto;">No Projects Yet</div>',apiKey:'',authDomain:'',projectId:'',enableOffline:!0,firebaseConfig:{},settings:{timestampsInSnapshots:!0},size:!1,currentPageOpen:function(){console.log('Current page already open')},i18n:{},resizer:1,minScreenSize:320,dragDampen:1,hideOnZoom:1}),t);e.I18n.addMessages(he({en:ue},n.i18n)),e.TemplateManager=new z(e,n),e.PagesApp=new R(e,n),e.SettingsApp=new B(e,n),de(e,n),W(e,n),le(e,n),e.on('load',a()(c.a.mark((function t(){var r,a,o,i;return c.a.wrap((function(t){for(;1;)switch(t.prev=t.next){case 0:if(r=e.Storage.getCurrentStorage(),(a=n.customLoad)&&'function'==typeof a&&a(e,r),a){t.next=23;break}return t.next=6,r.loadAll();case 6:if(o=t.sent,!(i=o[0])||!n.loadFirst){t.next=21;break}return r.setId(i.id),r.setName(i.name),r.setThumbnail(i.thumbnail),r.setIsTemplate(i.template),r.setDescription(i.description||''),r.setGlobalSetting(i.globalSetting||''),t.next=17,e.load();case 17:e.stopCommand('sw-visibility'),e.runCommand('sw-visibility'),t.next=23;break;case 21:r.setId(e.runCommand('get-uuidv4')),r.setName("Default-".concat(r.currentId.substr(0,7)));case 23:case"end":return t.stop()}}),t)}))))}}])}));
//# sourceMappingURL=grapesjs-project-manager-plus.min.js.map